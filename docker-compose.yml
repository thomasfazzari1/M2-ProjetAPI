services:
  authentification:
    build:
      context: authentification
    env_file:
      - .env
    ports:
      - "5001:5000"
    environment:
      - AUTH_DB_HOST=${AUTH_DB_HOST}
      - AUTH_DB_NAME=${AUTH_DB_NAME}
      - AUTH_DB_USER=${AUTH_DB_USER}
      - AUTH_DB_PASSWORD=${AUTH_DB_PASSWORD}

  match:
    build:
      context: ./match
    env_file:
      - .env
    ports:
      - "5003:5000"
    environment:
      - MATCH_DB_HOST=${MATCH_DB_HOST}
      - MATCH_DB_NAME=${MATCH_DB_NAME}
      - MATCH_DB_USER=${MATCH_DB_USER}
      - MATCH_DB_PASSWORD=${MATCH_DB_PASSWORD}

  api_gateway:
    build:
      context: ./api_gateway
    env_file:
      - .env
    ports:
      - "5000:5000"
    depends_on:
      - authentification
      - match
    environment:
      - AUTHENTIFICATION_SERVICE_URL=${AUTHENTIFICATION_SERVICE_URL}
      - MATCH_SERVICE_URL=${MATCH_SERVICE_URL}

  frontend:
    build:
      context: ./frontend
    env_file:
      - .env
    ports:
      - "5002:5000"
    depends_on:
      - api_gateway
    environment:
      - API_GATEWAY_URL=${API_GATEWAY_URL}
    volumes:
      - ./frontend:/app/frontend

volumes:
  mysql_data:
